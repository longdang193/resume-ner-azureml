# Conda Environment Definition for Training
# This file defines the Python dependencies for the training environment
# Using OpenMPI base image + explicit PyTorch definition for reproducibility

name: resume-ner-training
channels:
  - pytorch
  - conda-forge
  - defaults
dependencies:
  - python=3.10
  - pytorch>=2.6.0  # PyTorch 2.6+ required by transformers>=4.35.0 due to CVE-2025-32434 security fix
  # - cpuonly  # CPU-only PyTorch installation (lightweight, no CUDA)
  - pip
  - pip:
    - azureml-defaults  # Required for Azure ML tracking/logging
    - transformers>=4.35.0,<5.0.0  # Requires PyTorch>=2.6.0 for safe model loading
    - safetensors>=0.4.0  # Prefer safetensors format for model weights (avoids torch.load security check)
    - datasets>=2.12.0
    - numpy>=1.24.0,<2.0
    - pandas>=2.0.0
    - scikit-learn>=1.3.0
    - azure-ai-ml>=1.0.0
    - azure-identity>=1.12.0
    - azure-storage-blob>=12.17.0
    - pyyaml>=6.0
    - tqdm>=4.65.0
    - seqeval>=1.2.2
    - sentencepiece>=0.1.99  # Required for DeBERTa slow tokenizer (use_fast=False)
    - mlflow  # For experiment tracking
    - azureml-mlflow  # Azure ML MLflow integration
    - onnxruntime  # For Phase 2 inference (ONNX model serving)
    - onnx>=1.16.0  # Required for ONNX export/validation + onnxruntime quantization tooling
    - onnxscript>=0.1.0  # Required by PyTorch's ONNX export (torch.onnx.export) in PyTorch 2.6+
    # Testing dependencies
    - pytest>=7.0.0
    - pytest-cov>=4.0.0
    - pytest-mock>=3.10.0
    - pytest-xdist>=3.0.0  # Optional: parallel test execution



